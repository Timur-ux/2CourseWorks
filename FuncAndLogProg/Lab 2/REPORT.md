## Отчет по лабораторной работе №2

## по курсу "Логическое программирование"

## Решение логических задач

### студент: Бучкин Т.А.

|Группа     |Номер по списку|
|-----------|---------------|
|М8О-201Б-22| 2             |

## Результат проверки

| Преподаватель     | Дата         |  Оценка       |
|-------------------|--------------|---------------|
| Сошников Д.В. |              |               |
| Левинская М.А.|              |               |

> *Комментарии проверяющих (обратите внимание, что более подробные комментарии возможны непосредственно в репозитории по тексту программы)*

## Введение

Логические задачи решаются обычно табличным методом, когда составляется таблица, где столбцы составляют объекты, о которых говориться в задаче, а строки -- объекты, с которыми взаимодействуют объекты из столбцов. Данная таблица представляет так называемое фазовое пространство данной задачи, т.е. множество всех её возможных вариантов входных данных. На пересечении столбца и строки мы ставим "+", если данное сочетание подходит, или "-" в противном случае. Решаем, подходит данное сочетание или нет, мы, исходя из посылок задачи, т.е. утверждениях об объектах задачи, которые обязательно должны быть.

Преимущество использования Prolog для решения соответствующих задач заключается в том, что мы можем запрограммировать генерацию фазового пространства задачи, а также проверки её посылок. Т.е. сделать то, чем занимается информатика в целом -- переложить рутинную работу с человека на машину. Человеку остается только творческая часть задачи, которая состоит в извлечении суждений об объектах задачи из её описания.

## Задание

№ 2. В одном городе живут 7 любителей птиц. И фамилии у них птичьи. Каждый из них  тезка птицы, которой владеет один из его товарищей. У троих из них живут птицы, которые темнее, чем пернатые "тезки"их хозяев. "Тезка"птицы, которая живет у Воронова, женат. Голубев и Канарейкин единственные холостяки из всей компании. Хозяин грача женат на сестре жены Чайкина. Невеста хозяина ворона очень не любит птицу, с которой возится ее жених. "Тезка" птицы, которая живет у Грачева, хозяин канарейки. Птица, которая является "тезкой" владельца попугая, принадлежит "тезке" той птицы, которой владеет Воронов. У голубя и попугая оперение светлое. Кому принадлежит скворец?

## Принцип решения

Идея в том, чтобы сформировать семерку троек, каждая из которых представляет собой (человек, птица, женат/не женат). Подобные семёрки проверить на все условия задания, и если они проходят -- получить из данной семёрки хозяина скворца и напечатать его.

Особенности решения:

1. Существуют 3 человека -- хозяина более тёмной птицы, чем птица-тезка хозяина. Значит существует, как минимум, 3 светлых птицы. Если светлых птиц будет больше 4, то тёмных будет меньше 3, и наоборот, если светлых будет менше 3, то в силу однозначности человек-птица **более** темных птиц будет также меньше 3. Следовательно количество светлых птиц лежит в отрезке [3, 4]. Нам явно указали только 2 светлых птицы, а значит еще 1 или 2 -- надо взять перебором. Как выяснилось в дальнейшем, для единственности решения необходимо, чтобы тёмными птицами были ворон, грач и скворец, поэтому список *светлых* птиц будет состоять из неуказанных выше и объявлен явно.

2. Формирование отношений. Под отношениями подразумеваются указанные выше семерки из троек, однозначно задающих людей, птиц, и состояние женатости этих людей. Формирование происходит в предикате formRelations. Так как для любителей птиц верно следующее утверждение *Каждый из них  тезка птицы, которой владеет один из его товарищей.*, это значит, что *ни один из них не является тёзкой птицы, которой он владеет* **(1)**. Так как для любителей птиц верно следующее утверждение *Голубев и Канарейкин  единственные холостяки из всей компании.*, это значит, что *все кроме Голубева и Канарейкина -- женаты* **(2)**. Соответственно, в предикате формирования отношений мы сразу будет проверять условия **(1)** и **(2)**, чтобы сузить количество перебираемых вариантов. Код formRelations:

```prolog
formRelations([], [], []).
formRelations([Person | Persons], Birds, [(Person, Bird, IsMarried) | Tail]) :-
	memberWithTail(Bird, Birds, BTail),
	p2b(Person, Bird1), Bird \= Bird1, % (1)
	( (isHeMarried(Person), IsMarried = true) ; (IsMarried = false) ), % (2)

	formRelations(Persons, BTail, Tail).
```

3. Предикат валидации отношений `chek(Relations)`. В нем последовательно проверяются следующие условия:
   1. Подсчёт количества человек с птицами, более тёмными, чем птица "тёзка" их хозяина.
   2. Женатость "тёзки" птицы, живущей у Воронова.
   3. Женатость хозяина грача.
   4. Хозяин грача не Чайкин.
   5. Хозяин ворона не женат.
   6. "Тезка" птицы, которая живет у Грачева, хозяин канарейки.
   7. Птица, которая является "тезкой" владельца попугая, принадлежит "тезке" той птицы, которой владеет Воронов.

	Исходный код check(Relations):

```prolog
check(Relations, LightBirds) :-
	getMoreDarkPBPairs(Relations, LightBirds, Pairs), % (1)
	len(Pairs, N),
	3 is N,

	member((voronov, Bird1, _), Relations), % (2)
	b2p(Bird1, Person1),
	member((Person1, _, true), Relations),

	member((GrachMaster, grach, true), Relations), % (3)
	GrachMaster \= chaikin, % (4)

	member((_, voron, false), Relations), % (5)

	member((grachev, Bird2, _), Relations), % (6)
	b2p(Bird2, Person2),
	member((Person2, kanareika, _), Relations),

	member((voronov, Bird3, _), Relations), % (7)
	b2p(Bird3, Person3),
	member((Person4, popugai, _), Relations),
	p2b(Person4, Bird4),
	member((Person3, Bird4, _), Relations).
```

4. Также следует упомянуть предикат memberWithTail, который перебирает элементы и хвосты списка. Данный предикат является аналогом select -- встроенного предиката. Мы проходимся по всем элементам списка, а также для каждого из них формируем соответствующие хвосты. Реализация через предикат append не подойдёт, так как в при его использовании не будут перебраны **все** возможные варианты. Код memberWithTail:

```prolog
memberWithTail(Elem, [Elem | Tail], Tail).
memberWithTail(Elem, [ListHead | ListTail], Tail) :- memberWithTailInner(ListTail, ListHead, Elem, Tail).

memberWithTailInner(Tail, Elem, Elem, Tail).
memberWithTailInner([ListTailHead|ListTailTail], Head, Elem, [Head|TailTail]) :- memberWithTailInner(ListTailTail, ListTailHead, Elem, TailTail).
```

5. В результате мы получаем 4 одинаковых ответа, в которых утверждается, что мастер скворца -- Чайкин. Так как мы перебираем все возможные сочетания, то сложность решения будет равна:
   7 человек, каждый может быть мастером одной из 6 птиц. Тогда общее количество вариантов ` N = 7*6 * 6*5 * 5*4 * 4*3 * 3*2 * 2*1 `, тогда ` O(N) = O((!N)**2)`, где N -- количество любителей птиц.

## Выводы

В результате данной работы я научился решать логические задачи, используя средства языка Prolog. На маленьких входных данных быстрее будет использовать табличный метод, однако при больших данных использование Prolog даст огромный прирост в скорости решения. Я предполагаю, что использование Prolog даст выйгрыш по времени, начиная уже с 5-ти мерных(Если написаны стандартные предикаты формирования отношений) или с 15-ти мерных(если не написаны) входных данных. Если же размерность данных меньше, решить задачу "руками" будет быстрее, чем писать программу.
